Abstract  Improved a quadrotor technology that is capable of fast maneuvering requires accurate attitude estimation or navigation to maintain a quadrotor stability. The GPS can provide position measurements with an accuracy of several meters, but cannot provide orientation information directly. This study aims to design a quadrotor attitude navigation system based on IMU sensors on AR Drone 2.0 with a Kalman filter using the equation of state space model. The system model was developed using the Matlab software. The Kalman filter is designed as an estimator to reduce noise on the sensor so that it can improve measurement accuracy. The test results showed that the system model can be used to estimated the orientation angle and shift of the quadrotor, while the Kalman filter that designed can reduce noise in the sensor data. At the time of tested, the system provided the measurement accuracy of above 90% when tested indoor. Keywords: Kalman-filter, IMU, Navigasi, Quadrotor, State-space. 1. Pengantar Baru-baru ini, quadrotor yang merupakan salah satu jenis unmaned aerial vehicle (UAV) menjadi populer dan mendapatkan perhatian yang meningkat dari para peneliti dan hobbiest dalam aeromodeling. Beberapa faktor yang berkontribusi pada popularitasnya adalah keandalannya dalam manuver, tidak membutuhkan tempat luas untuk mendarat, dapat dengan aman berada di dalam ruangan, dan aplikasinya sangat luas. Navigasi attitude merupakan masalah penting pada quadrotor dan UAV secara umum. Estimasi sikap (attitude) yang merupakan bagian dari sistem navigasi pada quadrotor secara khusus penting untuk menjaga kestabilan quadrotor di lingkungan indoor yang kompleks [1]. Sistem navigasi sikap yang akurat dapat menggunakan giroskop mekanik. Namun, giroskop mekanik tidak bisa memberikan informasi berupa data pengukuran. Penggunaan global positioning systems (GPS) dapat memberikan pengukuran posisi yang akurat [2], namun memiliki keterbatasan dalam lingkungan tertentu yang menyebabkan terputusnya sinyal, seperti di dalam gedung, lingkungan urban, dan di bawah air. Pada umumnya, quadrotor dan UAV memiliki keterbatasan sumber daya baterai. Untuk mengatasi masalah ini, digunakan sistem navigasi inersia menggunakan sensor inertial measurement unit (IMU) berbasis teknologi micro-electro mechanical systems (MEMS) yang memiliki bentuk kecil, ringan, dan konsumsi daya rendah [3]. Namun, MEMS memiliki derau yang besar, akurasinya rendah, bias error dan tidak memberikan data estimasi sikap secara langsung [4]. Penelitian yang dilakukan oleh Shen dkk. [5] telah menggunakan scanning laser range finder (LRF) untuk estimasi posisi dan orientasi sebuah quadrotor. Penelitian tersebut menggunakan metode SLAM dan Kalman filter. Penggunaan LRF sebagai sistem navigasi  SENATIK 2018, Vol. IV, ISBN 978-602-52742-0-6 ROB-352 juga telah dilakukan oleh Bry dkk. [6] yang diterapkan pada UAV fixed-wing. Dalam penelitian tersebut, digunakan sensor planar LRF dan IMU menggunakan algoritme Gaussian Particle Filter (GPF). Perancangan sistem navigasi dengan multi sensor dapat ditemukan dalam [7] yang menggunakan sensor LRF, optical flow camera, IMU, dan barometer untuk navigasi wahana dalam ruangan. Menurut Goh dkk. [2], semakin banyak penggunaan sensor akan menambah beban komputasi. Kalman filter telah menjadi subjek aplikasi dan penelitian yang luas, terutama di navigasi otonom dan navigasi terpandu. Kalman filter dapat berfungsi untuk meminimalkan varian kesalahan dari estimasi pengukuran. Kebutuhan komputasi yang kecil, sifat rekursif, dan sebagai estimator optimal adalah keberhasilan besar dari Kalman filter [8]. Dengan mempertimbangkan kelebihan yang dimiliki, algoritme Kalman filter dapat digunakan sebagai estimator data navigasi. Dalam penelitian ini, kita menyajikan pengembangan sistem navigasi sikap quadrotor berbasis sensor IMU dengan metode Kalman filter dalam model state space. Navigasi sikap dalam kasus ini berupa estimasi sudut roll, picth, yaw ketika quadrotor sedang melakukan gerak rotasi/orientasi. Algoritme Kalman filter dipilih karena mempertimbangkan kelebihan yang dimiliki. Algoritme dikembangkan menggunakan perangkat lunak Matlab untuk menguji model yang telah dirancang. Hasil penelitian ini diharapkan dapat memberikan kontribusi pada pengembangan sistem navigasi orientasi berbasis IMU untuk estimasi orientasi quadrotor. Pada penelitian selanjutnya, model akan dikembangkan untuk estimasi pergeseran translasi quadrotor berbasis IMU. 2. Metodologi Penelitian 2.1 Quadrotor AR Drone 2.0 Dalam penelitian ini, digunakan quadrotor AR Drone 2.0 tipe X sebagai objek penelitian. Dalam aplikasinya, quadrotor AR Drone 2.0 didukung oleh hotspot wi-fi sehingga kontrol fisik quadrotor dapat dilakukan dengan ponsel pintar atau tablet maupun laptop. Pembacaan data sensor IMU (accelerometer, gyroscope, magnetometer) pada AR Drone dilakukan saat quadrotor terhubung dengan laptop melalui jaringan wi-fi. Kemudian, data diolah secara offline menggunakan Matlab. Gambar 1 menunjukkan quadrotor AR Drone 2.0, sedangkan spesifikasi perangkat elektronis (electronic assistance) ditunjukkan pada Tabel 1.  Gambar 1. Quadrotor.  Tabel 1. Spesifikasi Perangkat Elektronis Quadrotor. (Sumber:http://www.parrot.com/global/drones/parrot -ardrone-20-power-edition#technicals) Processor ARM Cortex A8 1 GHz 32-bit processor with DSP video 800 MHz TMS320DMC64x  OS Linux 2.6.32 RAM DDR2 1 GB at 200 MHz USB High-speed USB 2.0 for extensions Wi-Fi b g n Gyroscope 3 axles, accuracy of 2,000°/second Accelerometer 3 axles, accuracy of +/- 50 mg Magnetometer 3 axles, accuracy of 6° Pressure sensor Accuracy of +/- 10 Pa Altitude ultrasound sensor  Measures altitude  Vertical camera QVGA 60 FPS to measure the ground speed  ROB-353 ATTITUDE ESTIMATION...(Lasmadi) 2.2 Pengolahan Data Sensor IMU Pembacaan data sensor IMU pada AR Drone dilakukan pada saat quadrotor terhubung dengan laptop melalui jaringan wi-fi. Sebelumnya, program Robot Operating System (http://www.ros.org/) harus di-install di laptop pada sistem operasi Linux Ubuntu. Quadrotor digerakkan menggunakan tangan untuk mendapatkan data gerakan orientasi maupun translasi. Pada saat quadrotor digerakkan, data dibaca di laptop. Untuk memulai dan mengakhiri proses pembacaan data, digunakan tombol tertentu pada keyboard. Dengan menggunakan bahasa C, data pembacaan sensor pada ROS disimpan ke dalam format xls. Kemudian, data diolah secara offline menggunakan Matlab. Skema pembacaan data dengan laptop dari quadrotor dan pengolahan data dapat ditunjukkan pada blok diagram Gambar 2.  (a) Pembacaan data sensor (online) (b) Data processing (offline) Gambar 2. Skema set-up pembacaan data sensor dan pemrosesan data.  2.3 Matrik Transformasi Sinyal data yang terukur oleh sensor adalah dalam koordinat bodi (body frame). Untuk mengubah data pengukuran dari koordinat bodi ke koordinat navigasi digunakan matriks transformasi sebagaimana persamaan (1) [9]. aWi = BR W [aBi ] ,  BR W = cθcψ sφsθcψ − cθsψ cφsθcψ + sφsψ cθsψ sφsθsψ + cφcψ cφsθsψ − sφcψ −sθ sφcθ cφcθ  (1)  dengan, aWi = [aWx aWy aWz ] T dan aBi = [aBx aBy aBz ] T .  Matriks transformasi BR  W digunakan untuk mengkonversi dari koordinat bodi (sensor) ke koordinat global, aBi adalah percepatan dalam koordinat bodi, aWi adalah percepatan dalam koordinat global, dengan i adalah indeks aksis (i ε {x,y,z}), c mewakili kosinus, s mewakili sinus, θ adalah sudut roll, φ adalah sudut pitch dan ψ adalah sudut yaw. 2.4 Perancangan Kalman Filter dengan State Space Kalman filter dirancang sebagai estimator sudut dan posisi pergerakan quadrotor dari data pengukuran sensor giroskop. Dalam perancangan Kalman filter sebagai estimator parameter, dibutuhkan pengetahuan dinamika sistem. Untuk menghitung sudut orientasi, dapat diturunkan dari kecepatan angular (ω) menggunakan persamaan (2) dan (3). Ωk = Ωk−1 + ωk−1 − gbk−1  T (2)  gbk = gbk−1  (3)  dengan Ω notasi sudut, ω sebagai kecepatan angular, gb  sebagai bias giroskop dan T adalah periode sampling. Informasi dari giroskop dapat dipengaruhi oleh kesalahan tegangan bias,  SENATIK 2018, Vol. IV, ISBN 978-602-52742-0-6 ROB-354 sehingga perlu diperhitungkan dalam persamaan dinamika sistem untuk mengoreksi nilai kecepatan angular. Dalam merancang model state space untuk sensor giroskop, vektor state X ditentukan sebagai berikut. Xk = [θ θ φ φ φ φ ] T  (4) dengan θ adalah kecepatan angular di aksis-x, φ adalah kecepatan angular di aksis-y dan φ adalah kecepatan angular di aksis-z pada koordinat sensor. Algoritme Kalman filter mengasumsikan bahwa keadaan suatu sistem pada waktu k berevolusi dari keadaan sebelumnya pada waktu k-1 sesuai dengan persamaan (5) [8]. Xk = Aixk−1 + Biuk + wk  (5) dengan Xk adalah vektor state, uk adalah vektor input kontrol dalam hal ini kecepatan angular, Ai adalah matriks transisi state setiap parameter pada waktu k-1 yang mempengaruhi state sistem pada waktu k, Bi adalah matriks input kontrol, dan wk adalah vektor yang berisi derau proses untuk setiap parameter dalam vektor state. Derau proses diasumsikan terdistribusi normal rata-rata nol dengan kovarian yang diberikan oleh matriks kovarian Qk. Bila T adalah waktu sampling data setiap aksis pada sensor, matrik A, B, Q, dapat dapat dimodelkan dalam state space sebagai berikut.  A = 1 −T 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 −T 1 0 0 0 0 1 0 0 0 −T 1 , B = T 0 T 0 T 0 , Q = λ 0 0 0 0 0 0 λ 0 0 0 0 0 0 0 0 0 0 0 0 λ 0 0 0 0 λ 0 0 0 0 λ 0 0 0 0 λ ,  dengan λ adalah parameter tuning. Untuk mendapatkan estimasi state atau variabel output pengukuran dari sistem, dapat dilakukan dengan model persamaan (6) [8], ɀk = Cixk + δk  , (6) dengan ɀk adalah vektor pengukuran, Ci adalah matriks transisi, δk adalah vektor yang berisi derau pengukuran untuk setiap pengamatan dalam vektor pengukuran. Sebagaimana derau proses, derau pengukuran diasumsikan terdistribusi normal rata-rata nol dengan kovarian yang diberikan oleh matriks Rk. Matriks C dan R ditentukan sebagai berikut.  C = 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0  , R = cov  ωx 0 0 0 ωy 0 0 0 ωz .  ROB-355 ATTITUDE ESTIMATION...(Lasmadi) 2.5 Perhitungan Nilai Kesalahan dan Akurasi Nilai kesalahan (error) menunjukkan nilai perbedaan dengan nilai sebenarnya (referensi) yang dihitung dengan rumus: E = |Ref−Po | Ref  (13)  dengan Ref adalah nilai referensi dan Po adalah nilai hasil pengukuran. Akurasi merupakan nilai yang dinyatakan dalam persen (%) yang menunjukkan akurasi algoritme yang digunakan. Dalam kasus ini, nilai akurasi dihitung dengan rumus: Akurasi = 1 − E × 100, (14) dimana, E dihitung berdasarkan Persamaan (13). 3. Hasil dan Pembahasan 3.1 Pengujian Keadaan Stasioner Pengujian keadaan stasioner dilakukan pada sensor ketika quadrotor pada kondisi statis, dimana posisi (x,y,z) = (0,0,0) m dan sudut orientasi ditetapkan sebagai (roll,pitch,yaw) = (0,0,0) rad. Pada keadaan stasioner, idealnya, sinyal data dari sensor giroskop akan menunjukkan nol. Dengan menerapkan metode kompensasi dan Kalman filter sebagaimana yang dilakukan pada [10], hasil pengujian sensor giroskop saat kondisi stasioner dapat ditunjukkan pada Gambar 3.  (a) Sinyal data giroskop sebelum filtering (b) Sinyal data giroskop setelah filtering  Gambar 3. Sinyal data giroskop pada kondisi statis.  Gambar 3(a) menunjukkan sinyal data giroskop sebelum dari aksis-x,y,z ketika quadrotor pada kondisi statis. Paku-paku (spikes) pada sinyal menunjukkan bahwa sinyal berderau akibat gaya, dinamika sensor, dan lain-lain. Gambar 3(b) menunjukkan sinyal data giroskop setelah penapisan dan kompensasi. Idealnya, pada kondisi statis, amplitudo sinyal adalah nol. Sebagaimana dapat dilihat pada Gambar 3(b), spike noise telah dihilangkan dari sinyal. Ini menunjukkan bahwa algoritme mampu menghilangkan derau (noise) sinyal pada kondisi stasioner. 0 200 400 600 800 1000 1200 1400 1600 1800 2000 -5 0 5 x 10-3 Angular rate signal of the axis-X  Sampling  Output (rad/s)  0 200 400 600 800 1000 1200 1400 1600 1800 2000 -0.01 0 0.01  Angular rate signal of the axis-Y  Sampling  Output (rad/s)  0 200 400 600 800 1000 1200 1400 1600 1800 2000 -0.01 0 0.01  Angular rate signal of the axis-Z  Sampling  Output (rad/s)  v-roll  v-pitch  v-yaw  0 200 400 600 800 1000 1200 1400 1600 1800 2000 -1 0 1  Angular rate signal of the axis-X  Sampling  Output (rad/s)  0 200 400 600 800 1000 1200 1400 1600 1800 2000 -1 0 1  Angular rate signal of the axis-Y  Sampling  Output (rad/s)  0 200 400 600 800 1000 1200 1400 1600 1800 2000 -1 0 1  Angular rate signal of the axis-Z  Sampling  Output (rad/s)  v-roll  v-pitch  v-yaw  SENATIK 2018, Vol. IV, ISBN 978-602-52742-0-6 ROB-356 3.2 Estimasi Sudut Orientasi Data yang diperoleh dari sensor giroskop berupa data kecepatan sudut. Dengan metode Kalman filter, data kecepatan sudut digunakan untuk mendapatkan estimasi sudut  orientasi atau rotasi. Estimasi sudut roll (φ) didapatkan dari data kecepatan sudut pada aksis- x dan estimasi sudut pitch (θ) didapatkan dari data kecepatan sudut pada aksis-y. Sedangkan  estimasi sudut yaw (ψ) didapatkan dari data kecepatan sudut pada aksis-z. Untuk mendapatkan data kecepatan sudut, quadrotor diputar (digoyangkan) pada aksis yang bersangkutan. Pengambilan data dilakukan selama kurang lebih dua menit. Pengujian estimasi sudut roll (φ) dilakukan dengan memutar rangka quadrotor terhadap aksis−x dengan sudut bervariasi. Hasil pengujian estimasi sudut roll ditunjukkan pada Gambar 4.  (a) Grafik kecepatan sudut ωx (b) Grafik estimasi sudut roll Gambar 4. Grafik hasil pengujian estimasi sudut roll.  Gambar 4(a) menunjukkan grafik kecepatan sudut (rad) saat rangka diputar pada aksis-x, sedangkan kecepatan sudut terhadap aksis-y dan aksis-z idealnya mendekati nol karena pengaruh gaya terbesar ada di aksis-x. Gambar 4(b) menunjukkan grafik hasil estimasi sudut roll berdasarkan data kecepatan sudut pada Gambar 4(a). Pengujian dilakukan dengan membandingkan hasil estimasi menggunakan metode LPF (Low Pass Filter), metode KF (Kalman Filter), serta metode integral langsung. Berdasarkan grafik, KF yang dirancang mampu memberikan respon lebih cepat dibanding LPF dan integrasi langsung. Pengujian estimasi sudut pitch (θ) dilakukan dengan memutar rangka quadrotor terhadap aksis−y dengan sudut bervariasi. Hasil pengujian estimasi sudut pitch dapat ditunjukkan pada Gambar 5.  (a) Grafik kecepatan sudut ωy  (b) Grafik estimasi sudut pitch  Gambar 5. Grafik hasil pengujian estmasi sudut pitch.  Gambar 5(a) menunjukkan grafik kecepatan sudut (rad) saat rangka diputar pada aksis-y, sedangkan kecepatan sudut terhadap aksis-x dan aksis-z idealnya mendekati nol karena pengaruh gaya terbesar ada di aksis-y. Gambar 5(b) menunjukkan grafik hasil estimasi sudut pitch berdasarkan data kecepatan sudut pada Gambar 5(a). Bila dibandingkan dengan metode LPF dan integral langsung, metode KF untuk estimasi sudut pitch mampu 0 500 1000 1500 2000 2500 -6 -4 -2 0 2 4 6  Sampling  Angular velocity (rad/s)  Data Sensor Giroskop tanpa Penapisan  v-roll v-pitch v-yaw  0 500 1000 1500 2000 2500 -1.5 -1 -0.5 0 0.5 1 1.5  Sampling  Roll angle(rad)  Estimated Roll Angle  Direct Integration with LPF with KF  0 200 400 600 800 1000 1200 1400 -5 0 5  Sampling  Angular velocity (rad/s)  Data Sensor Giroskop tanpa Penapisan  v-roll v-pitch v-yaw  0 200 400 600 800 1000 1200 1400 -1.5 -1 -0.5 0 0.5 1 1.5  Sampling  Pitch angle(rad)  Estimated Pitch Angle  Direct Integration with LPF with KF  ROB-357 ATTITUDE ESTIMATION...(Lasmadi) memberikan respon lebih cepat dibanding LPF dan integrasi langsung. Pengujian estimasi sudut yaw (ψ) dilakukan dengan memutar rangka quadrotor terhadap aksis−z dengan sudut bervariasi. Hasil pengujian estimasi sudut pitch dapat ditunjukkan pada Gambar 6.  (a) Grafik kecepatan sudut ωz  (b) Grafik estimasi sudut yaw  Gambar 6. Grafik hasil pengujian estmasi sudut yaw.  Gambar 6(a) menunjukkan grafik kecepatan sudut (rad) saat rangka diputar pada aksis-z, sedangkan kecepatan sudut terhadap aksis-x dan aksis-y idealnya mendekati nol karena pengaruh gaya terbesar ada di aksis-z. Gambar 6(b) menunjukkan grafik hasil estimasi sudut yaw berdasarkan data kecepatan sudut pada Gambar 6(a). Bila dibandingkan dengan metode LPF dan integral langsung, metode KF untuk estimasi sudut yaw mampu memberikan respon lebih cepat dibanding LPF dan integrasi langsung. Hasil pengujian dengan memutar rangka quadrotor terhadap aksis-x, aksis-y, dan aksis-z masing-masing dengan sudut 45o (0,7854 rad) terhadap garis horisontal dapat ditunjukkan pada Tabel 1.  Tabel 1.Estimasi sudut roll, pitch, dan yaw.  No. Sudut Ref. (rad) Estimasi (rad) Kesalahan (rad) Akurasi (%) LPF KF LPF KF LPF KF 1 Roll 0,7854 0,7441 0,7705 0,0413 0,0149 94,74 98,10 2 Pitch 0,7854 0,7974 0,7829 0,0120 0,0025 98,47 99,68 3 Yaw 0,7854 0,8051 0,76 0,0197 0,0254 97,49 96,77 Pada Tabel 1, kolom Sudut menunjukkan besar sudut orientasi yang diujikan (RPY), kolom Ref. (referensi) adalah sudut acuan dan kolom Estimasi menunjukkan hasil estimasi dengan algoritme. Kolom Kesalahan menunjukkan nilai perbedaan dengan referensi yang dihitung menggunakan Persamaan (13) dan kolom akurasi menunjukkan akurasi algoritme yang dihitung menggunakan Persamaan (14). Berdasarkan hasil pengujian, sebagaimana ditunjukkan dalam Tabel 1, pengujian dengan metode KF menghasilkan akurasi estimasi 98,10% untuk roll, 99,68% untuk pitch, dan 96,77% untuk yaw. 4. Kesimpulan Berdasarkan hasil pengujian, Kalman filter yang dirancang mampu mengurangi derau pada sinyal data sensor IMU. Algoritme dapat memberikan estimasi sudut orientasi roll, pitch, yaw dengan akurasi yang dapat diterima setidaknya untuk waktu yang singkat. Berdasarkan eksperimen, sistem dapat memberikan akurasi estimasi sudut sekitar 95%. Selain itu, Kalman filter dapat memberikan respon yang lebih cepat dibandingkan metode LPF dan integral langsung. Sejauh ini, algoritme diujikan secara off-line, untuk aplikasi secara real-time, algoritme ini dapat memiliki beberapa keterbatasan. 0 500 1000 1500 2000 2500 -4 -3 -2 -1 0 1 2 3 4 5  Sampling  Angular velocity (rad/s)  Data Sensor Giroskop tanpa Penapisan  v-roll v-pitch v-yaw  0 500 1000 1500 2000 2500 -2 -1.5 -1 -0.5 0 0.5 1 1.5 2 2.5  Sampling  Yaw angle (rad)  Estimated Yaw Angle  Direct Integration with LPF with KF  SENATIK 2018, Vol. IV, ISBN 978-602-52742-0-6 ROB-358 Daftar Pustaka [1] B. J. Emran, M. Al-omari, M. F. Abdel-hafez, and M. A. Jaradat, (2014), “A Cascaded Approach for Quadrotor’s Attitude Estimation,” in Procedia Technology, , vol. 15, no. 971, pp. 268–277. [2] S. T. Goh, O. Abdelkhalik, and S. A. R. Zekavat, (2013), “A Weighted Measurement Fusion Kalman Filter implementation for UAV navigation,” Aerosp. Sci. Technol., vol. 28, pp. 315–323. [3] J. D. Barton, “Fundamentals of Small Unmanned Aircraft Flight, (2012), ”John Hopkins APL Tech. Dig., vol. 31, no. 2, pp. 132–149. [4] B. Kada, K. Munawar, M. . Shaikh, and M. Hussaini, (2016), “UAV Attitude  Estimaton Using Nonlinear Filtering and Low-Cost MEMS Sensor,” IFAC- PapersOnLine, vol. 49, no. 21, pp. 521–528.  [5] S. Shen, N. Michael, and V. Kumar, (2011), “Autonomous Multi-Floor Indoor Navigation with a Computationally Constrained MAV,” in 2011 IEEE International Conference on Robotics and Automation (ICRA), pp. 20–25. [6] A. Bry, A. Bachrach, and N. Roy, (2012), “State Estimation for Aggressive Flight in GPS-Denied Environments Using Onboard Sensing,” in 2012 IEEE International Conference on Robotics and Automation, pp. 1–8. [7] W. Fei, C. Ben-mei, and L. E. E. T. H, (2013), “A Comprehensive UAV Indoor Navigation System Based on Vision Optical Flow and Laser FastSLAM,” Acta Autom. Sin., vol. 39, no. 11, pp. 1889–1899. [8] R. Faragher, (2012), “Understanding the Basis of the Kalman Filter Via a Simple and Intuitive Derivation,” IEEE Signal Process. Mag., vol. 29, no. September, pp. 128– 132. [9] K. D. Sebesta and N. Boizot, (2014), “A Real-Time Adaptive High-Gain EKF , Applied to a Quadcopter Inertial Navigation System,” IEEE Trans. Ind. Electron., vol. 61, no. 1, pp. 495–503. [10] L. Lasmadi, A. Cahyadi, S. Herdjunanto, and R. Hidayat, (2017), “Inertial Navigation for Quadrotor Using Kalman Filter with Drift Compensation,” Int. J. Electr. Comput. Eng., vol. 7, no. 5, pp. 2596–2604.