Abstract  In general, PLCs has digital inputs and outputs system. The PLC additional system for analog input on the PLC is limited to sensor output in the form of a voltage of 1-5V (or 4mA to 20mA current). The development of I2C-based sensor technology is not suitable for PLCs. In this research, an I2C-based sensors system was designed and made that can be connected to the PLC. Data from the I2C sensor is sent to the DM memory in the PLC via RS232 serial communication. The sensor used was an LDR as a light sensor and a BMP180 sensor to measure atmospheric pressure and room temperature. From the experiment, the results of the LDR sensor were 100% successful and the data transmission from the BMP180 sensor was well recognized in the PLC Keywords: ADC, Microcontroller, I2C Sensor, PLC. Abstrak  Pada umumnya PLC memiliki sistem masukan dan keluaran digital. Sistem tambahan PLC untuk masukan analog pada PLC terbatas hanya untuk keluaran sensor berupa tegangan 1- 5V (atau arus 4mA sampai 20mA). Perkembangan teknologi sensor berbasis I2C tidak cocok untuk PLC. Pada penelitian ini dirancang dan dibuat suatu sistem sensor berbasis I2C yang dapat disambungkan ke PLC. Data dari sensor I2C dikirimkan ke memory DM pada PLC melalui komunikasi serial RS232. Sensor yang digunakan yaitu LDR sebagai sensor cahaya dan sensor BMP180 untuk mengukur tekanan atmosfir dan suhu ruang. Dari percobaan diperoleh hasil sensor LDR berhasil 100% dan pengiriman data dari sensor BMP180 dapat dikenali dengan baik pada PLC Kata Kunci : ADC, Mikrokontroler, Sensor I2C, PLC 1. Pendahuluan PLC merupakan suatu peralatan untuk pengendali yang dapat diprogram. Pada umumnya PLC memiliki port masukan dan keluaran digital. Masukan analog pada PLC memerlukan peralatan tambahan (modul). Sensor berbasis analog dapat bekerja pada PLC Omron CPM2A dengan menggunakan Modul Analog Digital (MAD). MAD memiliki keterbatasan yaitu harga yang mahal dan belum mendukung untuk sensor berbasis I2C [1]. Berdasarkan permasalah tersebut, pada penelitian ini dibuat sistem sensor I2C untuk PLC dan pengolahan data sensor berbasis protokol I2C agar data sensor dapat disimpan didalam memori PLC Omron CPM2A menggunakan mikrokontroler. Mikrokontroler menggunakan ATmega328 pada board Arduino Uno dengan resolusi ADC 10 bit. Mikrokontroler memiliki kemampuan dalam mengolah sinyal analog menjadi digital. Pada pin mikrokontroler tersedia komunikasi protokol I2C dan komunikasi USART[2]. I2C merupakan suatu sistem yang dikembangkan oleh Philips semikonduktor [3] untuk mempermudah interkoneksi antara Chip, periperal dan bagian-bagian dalam sistem embeded. Komunikasi I2C menggunakan Serial Data Line (SDA) dan Serial Clock Line (SCL) secara bidirectional line. Transfer data pada protokol I2C berdasarkan keadaan sinyal, yaitu kondisi  SENATIK 2018, Vol. IV, ISBN 978-602-52742-0-6 KdI-334 Start dan Stop, Slave Address, ACKNOWLEDGE dan data. Protokol I2C ditunjukkan pada gambar 1 berikut ini.  Gambar 1. Transfer Data Protokol I2C [3]  PLC Omron CPM2A merupakan kontroler yang dapat diprogram. Komunikasi antara mikrokontroler dengan PLC menggunakan protokol Host-Link melalui kabel RS232 sebagai penghubung. Parameter komunikasi host link pada PLC CPM2A adalah baud rate 9600bps, 1 start bit, 7 bit data, 2 stop bit, even parity. Pengiriman data pada PLC mengikuti format Command Frame, terdiri dari @, Node No, Header Code, Alamat Memori DM, Data, Frame Check Sequence (FCS) dan Terminator [4] seperti ditunjukkan pada gambar 2.  Gambar 2. Format Command Frame [4]  Frame Check Sequence berfungsi untuk mengecek kesalahan frame data yang akan dikirim. Perhitungan FCS dilakukan secara berurutan mulai dari karakter pertama hingga karakter terakhir pada sebuah frame melalui operasi exclusive OR , dan menghasilkan 8 bit data seperti diperlihatkan pada gambar 3 contoh perhitungan FCS. Hasil perhitungan FCS dalam bentuk heksadesimal.  Gambar 3. Contoh Perhitungan FCS [4]  KdI-335 I2C SENSORS SYSTEM...(Alexander Rahma Angga Dewanta) 2. Metode Penelitian Sistem sensor I2C untuk PLC menggunakan mikrokontroler terdiri dari bagian bagian berikut seperti terlihat pada Gambar 4. Sensor berbasis I2C dihubungkan dengan mikrokontroler. (I2C menjadi salah satu feature standar pada mikrokontroler). Pada mikrokontroler Arduino lajur I2C terdapat pada pin A4 (SDA) dan pin A5 (SCL). Sensor analog lainnya dihubungkan pada pin A0 sampai A3. Pada penelitian ini sensor analog berupa LDR dihubungkan pada pin A0. Komunikasi antara mikrokontroler dengan PLC dihubungkan dengan modul konverter TTL ke RS232. Memori pada PLC dimooonitor menggunakan PC maupun dengan menggunakan konsol PLC . Pada mikrokontroler dimasukan script untuk membaca sensor I2C dan membaca data dari sensor analog. Data hasil pembacaan sensor dikemas agar data dimengerti oleh PLC melalui format tertentu. Pengambilan data dilakukan untuk melihat format data yang dikirim, bentuk sinyal pada I2C serta data yang diterima pada PLC.  Gambar 4. Diagram Blok Sistem Modul Analog ke Digital Konverter untuk PLC Sensor yang dipakai pada penelitian ini yaitu sensor Suhu dan Tekanan (menggunakan modul sensor BMP180 dan sensor LDR. Data sensor cahaya, sensor suhu dan sensor tekanan akan diolah oleh mikrokontroler. Hasil pengolahan data akan dikirim secara serial menggunakan kabel RS232 menuju PLC Omron CPM2A. Data akan disimpan di dalam memori PLC, untuk memantau data tersebut menggunakan komputer seperti ditunjukkan gambar 4. Pemantauan data yang dikirim oleh mikrokontroler menggunakan aplikasi “Terminal” dan console PLC. 3. Hasil Dan Pembahasan Penelitian ini menggunakan sensor LDR (cahaya) sebagai sensor berbasis analog dan sensor BMP180 (suhu dan tekanan) sebagai sensor berbasis I2C. Mikrokontroler mengolah data sensor untuk dikirim menuju PLC dan disimpan pada memori DM PLC. Pengolahan dan pembentukkan data sensor menjadi format Command Frame dilakukan oleh mikrokontroler. Modul RS232 to TTL Converter digunakan untuk mengubah level tegangan TTL mikrokontroler menjadi tegangan RS232, sehingga sinkron dengan port RS232 PLC. Monitoring data pada memori DM menggunaan program ladder PLC pada laptop. Untuk menambahkan jumlah port RS232 pada PLC ditambahkan RS-232 Adapter model CPM1-CIF01, penambahan bertujuan untuk menghubungkan PLC dengan laptop. Pemantauan data pada memori DM PLC dapat juga menggunakan OMRON Programming Console R001. Monitoring data dilakukan dengan menggunakan komputer atau Programming Console seperti ditunjukkan pada Gambar 5.  SENATIK 2018, Vol. IV, ISBN 978-602-52742-0-6 KdI-336  Gambar 5. Perangkat keras Sistem Sensor I2C untuk PLC  Data sensor dalam format Command Frame akan dikirim oleh mikrokontroler. Data yang dikirim dalam bentuk heksadesimal, karena format memori penyimpanan data pada PLC dalam bentuk heksadesimal. Data yang dikirim oleh mikrokontroler nilainya sama dengan yang diterima oleh PLC. Gambar 6 menunjukkan monitoring data yang dikirim oleh mikrokontroler  Gambar 6. Monitoring data terkirim  Gambar 7 memperlihatkan monitoring data menggunakan program ladder dan Programming Console. Monitoring data dalam bentuk heksadesimal dan BCD (Binary to Decimal Converter). Bentuk BCD untuk memudahkan dalam memantau nilai data sensor sesungguhnya (desimal). Pada penelitian data heksadesimal dan BCD setiap sensor memiliki alamat memori DM yang berbeda seperti ditunjukkan pada tabel 1. Kapasitas satu alamat DM adalah 16 bit (1 word). Setiap 1 karakter data menggunakan 4 bit (1 karakter = 1 nibble) sehingga 16 bit dapat menampung 4 karakter dan harus terpenuhi.  KdI-337 I2C SENSORS SYSTEM...(Alexander Rahma Angga Dewanta)  Gambar 7. Data tersimpan di dalam memory DM Tabel 1. Alamat memori DM PLC  No Jenis Sensor Alamat Memori (Hex) Alamat Memori (BCD) 1 LDR DM1 DM9 2 Suhu DM2 DM10 3 Tekanan DM3 DM11  Gambar 8. Data sensor pada Command Frame  Data terkirim : @00WD0001002B22*, menunjukkan Header Code nya WD (Write DM), alamat memori DM0001, data yang tersimpan didalam memori PLC adalah 002B. Hasil perhitungan FCS nya adalah 22 seperti ditunjukkan oleh gambar 8. Pengujian Sensor LDR (Sensor Analog) Pengujian sensor LDR dilakukan dengan mengukur tegangan keluaran rangkaian pembagi tegangan sensor LDR dan membandingkan data sensor yang dikirim dengan yang diterima PLC. Rangkaian pembagi tegangan LDR menggunakan resistor pull-down 1Kῼ. Pengukuran tegangan menggunakan multimeter Sanwa CD800A. Nilai intensitas cahaya yang mempengaruhi tegangan LDR dapat dilihat pada Lutron lx-100 Light Meter. Tabel 2 menunjukkan data hasil pengujian sensor LDR. Berdasarkan tabel 2 data berhasil dikirim dan tersimpan didalam memori PLC, ditunjukkan dengan nilai heksadesimal yang sama. Nilai tegangan yang terukur digunakan untuk perhitungan nilai ADC. Resistor 1 Kῼ memiliki jangkauan tegangan 0,201 volt hingga 4,204 volt. Data ADC yang tersimpan di memori DM 9 memiliki perbedaan dengan nilai perhitungan ADC dengan galat 2,78%. Galat dapat disebabkan oleh sensitivitas perubahan nilai sensor terhadap intensitas cahaya, sehingga pengamatan ketika peneliti mengambil data kurang cermat dan terdapat tunda pada proses transmisi data.  SENATIK 2018, Vol. IV, ISBN 978-602-52742-0-6 KdI-338  Tabel 2. Data Pengujian Sensor LDR  Pengujian Sensor BMP180 ( Sensor Protokol I2C) Pengujian sensor BMP180 dilakukan dengan mengamati komunikasi protokol I2C untuk mengetahui gelombang paket data selama komunikasi berlangsung. Gambar 9 menunjukkan gelombang SDA (gelombang berwarna kuning) dan SCL (gelombang berwarna biru) yang digunakan pada komunikasi berbasis protokol I2C. Berdasarkan gambar 9 paket data dimulai dengan keadaan “START” dengan kondisi gelombang SCL “high” dan SDA “falling edge”. Paket data memiliki 3 gelombang meliputi alamat sensor, data suhu dan data tekanan. Gelombang 1 adalah Slave address memiliki 7 bit data (nomer 1 gambar 10), pada bit ke 8 gelombang SDA memiliki kondisi 0, yang berarti sensor dalam keadaan “write” (nomer 2 gambar 9). Pada bit ke 9 (nomer 3 gambar 10) menyatakan nilai acknowledge by slave (ACKS)  agar address sensor dapat dikenali. Gelombang 2 (data suhu) dan 3 (data tekanan) masing- masing memiliki 8 bit data, yaitu sensor suhu (nomer 4 gambar 9) dan tekanan. Pada bit ke 9  (nomer 5 gambar 10) selalu diakhiri dengan acknowledge by slave (ACKS) agar data dapat dikenali oleh master. BMP180 berperan sebagai Slave dan mikrokontroler berperan sebagai Master. Paket data selesai pada keadaan “STOP” saat kondisi SCL “high” dan SDA “rising edge” .  Gambar 9. Sinyal Komunikasi I2C  No Intensitas Cahaya (lux) Tegangan Keluaran Sensor Cahaya (volt)  Data Terkirim  Data Tersimpan Didalam Memori PLC  Perhitungan Teori ADC  Galat ADC  Memori DM 1 (Heksadesimal)  Memori DM 9 (BCD)  1 20 0,201 @00WD0001002858* 0028 40 41,12 2,81% 2 80 0,604 @00WD000100815B* 0081 129 123,58 4,20% 3 190 1,053 @00WD000100E027* 00E0 224 215,44 3,82% 4 320 1,401 @00WD0001012859* 0128 296 286,64 3,16% 5 520 1,806 @00WD0001017054* 0170 368 369,51 0,41% 6 980 2,221 @00WD000101DA56* 01DA 474 454,42 4,13% 7 1730 2,624 @00WD000102285A* 0228 552 536,87 2,74% 8 2720 3,011 @00WD0001027453* 0274 628 616,05 1,90% 9 5410 3,432 @00WD000102C82B* 02C8 712 702,19 1,38% 10 1250 3,811 @00WD0001032053* 0320 800 779,73 2,53% 11 18350 4,204 @00WD0001037157* 0371 881 860,14 2,37% Rata-rata 2,78%  KdI-339 I2C SENSORS SYSTEM...(Alexander Rahma Angga Dewanta)  Gambar 10. Sinyal Alamat dan Data pada protokol I2C  Data suhu sensor BMP180 dalam bentuk heksadesimal berhasil dikirim dan tersimpan di dalam memori PLC Omron CPM2A. Data heksadesimal diubah menjadi BCD. Tabel 3 menunjukkan data suhu hasil percobaan sensor BMP180. Pembacaan sensor suhu BMP180 memiliki resolusi 0,1 C0  dan 16 bit data [5]. Memori PLC Omron CPM2A belum dapat menyimpan ketelitian angka dibelakang koma, sehingga peneliti mengolah output sensor pada program mikrokontroler sebagai contoh nilai suhu 29,30 akan diolah menjadi 2930 (seperti pada tabel 3 kolom 5 dan 4). Sistem Sensor I2C dengan sensor BMP180 sebagai input, dilakukan pengujian sebagai alat instrumentasi pengukuran suhu. Pembacaan suhu sensor BMP180 akan dibandingkan dengan termometer digital seri T110. Perbandingan tersebut memiliki galat 10%, galat tersebut dapat disebabkan oleh perbedaan spesifikasi sensor dan sensitivitas sensor. Linieritas alat instrumentasi terjadi pada suhu 35 C 0 hingga 62 C 0 (Gambar 9). Tabel 3. Data Hasil Pengujian Sensor Suhu BMP180  No Data Terkirim  Data Tersimpan Konversi Pembacaan Nilai BCD (Celcius)  Termometer (Celcius)  Galat Sebagai Alat Ukur Memori DM2 (Heksadesimal)  Memori DM 10 (BCD)  1 @00WD000201E92C* 01E9 489 4,89 3,9 20,25% 2 @00WD0002032858* 0328 808 8,08 6,6 18,32% 3 @00WD000204B82F* 04B8 1208 12,08 10,3 14,74% 4 @00WD0002064655* 0646 1606 16,06 14,2 11,58% 5 @00WD000207D82A* 07D8 2008 20,08 15,4 23,31% 6 @00WD000209635D* 0963 2403 24,03 22,1 8,03% 7 @00WD00020AF751* 0AF7 2807 28,07 28,5 1,53% 8 @00WD00020C912A* 0C91 3217 32,17 30,4 5,50% 9 @00WD00020E1C56* 0E1C 3612 36,12 32,9 8,91% 10 @00WD00020FA157* 0FA1 4001 40,01 35,9 10,27% 11 @00WD000212CA50* 12CA 4810 48,10 43,0 10,60% 12 @00WD0002145958* 1459 5209 52,09 47,3 9,20% 13 @00WD000215EC53* 15EC 5612 56,12 52,0 7,34% 14 @00WD000219575B* 1957 6487 64,87 61,8 4,73% Rata - rata 10,76%  SENATIK 2018, Vol. IV, ISBN 978-602-52742-0-6 KdI-340  Gambar 11. Grafik perbandingan Alat yang dibuat  Pengujian tekanan udara sensor BMP180 dilakukan dengan membandingkan tekanan udara pada ketinggian dari setiap lantai tingkat (lantai 4 tingkat) Gedung Barat Kampus III Universitas Sanata Dharma. Data heksadesimal berhasil dikirim dan tersimpan di dalam memori PLC Omron CPM2A. Data heksadesimal diubah menjadi BCD. Pembacaan tekanan udara dalam satuan inch mercury inHg (996,23 milibar = 29,41 inHg). Format pengiriman dengan mengolah nilai ketelitian angka dibelakang koma, sehingga nilai sebenarnya 29,34 inHg akan menjadi 2934 (BCD) didalam memori PLC DM 10. Data hasil pengujian ditampilkan pada tabel 4. Tabel 4. Data Hasil Pengujian Sensor Suhu BMP180  No Tempat Pengambilan Data  Data Terkirim  Data Tersimpan Pembacaan Nilai Tekanan pada Memori DM 11 (inHg)  Memori DM 3 (Heksadesimal)  Memori DM 11 (BCD)  1 Lantai 1 @00WD00030B7623* 0B76 2934 29,34 2 Lantai 2 @00WD00030B7623* 0B76 2934 29,34 3 Lantai 3 @00WD00030B7722* 0B77 2935 29,35 4 Lantai 4 @00WD00030B7B2C* 0B79 2937 29,37  Keunggulan dan Keterbatasan Alat Keunggulan alat : alat dapat membaca data dari sensor I2C dan dapat dihubungkan ke PLC. Pembacaan data analog pada PLC memerlukan modul AD khusus untuk PLC (yang harganya relatif mahal dibandingkan dengan alat buatan sendiri). Keterbatasan alat : format data sensor yang dipakai masih berupa data bilangan bulat positif saja. Untuk data negatif serta data bilangan pecahan (format data real) masih belum diimplementasikan. Kecepatan data masih terbatas kurang dari 10 sample per detik. Hal ini disebabkan pengolahan dan pengiriman data membutuhkan waktu 100ms. Untuk data dengan  KdI-341 I2C SENSORS SYSTEM...(Alexander Rahma Angga Dewanta) kecepatan perubahan yang besar dan memerlukan tempat penyimpanan data yang besar belum diimplementasikan. 4. Kesimpulan Berdasarkan hasil pengujian dan pengambilan data Sistem Sensor I2C menggunakan mikrokontroler, dapat disimpulkan sebagai berikut. Komunikasi antara mikrokontroler dengan PLC Omron CPM2A melalui kabel RS232 berhasil dilakukan. Mikrokontroler berhasil mengirim data analog dari sensor LDR (sensor berbasis analog) untuk disimpan didalam memori DM PLC Omron CPM2A dengan keberhasilan 100%. Mikrokontroler berhasil mengirim data suhu dan tekanan dari sensor BMP180 (sensor berbasis I2C) untuk disimpan didalam memori DM PLC Omron CPM2A dengan keberhasilan 100%. Pengolahan data analog menjadi digital berhasil dilakukan. Modul ADC dapat digunakan sebagai alat instrumentasi pengukuran cahaya (sensor LDR) dengan galat 2,78%, pengukuran suhu (sensor BMP180) dengan galat 10%. Ucapan Terimakasih Peneliti mengucapkan terimakasih kepada dosen pembimbing, Laboratorium Kendali dan Instrumentasi Teknik Elektro Universitas Sanata Dharma, atas fasilitas alat dan ruang yang dapat digunakan untuk penelitian. Daftar Pustaka [1] Omron, (2008), Data Sheet CJ1W-AD/DA/MAD, OMRON. [2] Atmel, (2016) , Data Sheet Microcontroler ATmega382/P, Atmel, San Jose [3] Irazabal, Jean-Marc., Blozis, Steve., (2003), AN10216-01 I2C MANUAL, NXP Semiconductors [4] Omron. (2008), Sysmac CPM1/CPM1A/CPM2A/CPM2C/SRM1(-V2) Programmable Controller: Programming Manual. Japan: Omron Corporation [5] Bosch, (2012), Data Sheet BMP180 Digital Pressure Sensor, Bosch Sensortec